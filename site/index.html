<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Mesh Sandbox â€” Minimal E2E</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <link rel="stylesheet" href="styles.css">
    <script>
      window.APP_CONFIG = window.APP_CONFIG || {
        apiBase: "https://p26ujrcetd.execute-api.us-east-1.amazonaws.com",
        meshClientId: "2195a20c-f0da-4c1d-f6ea-08de0fed221d"
      };
      window.MESH_LINK_SDK_URL = window.MESH_LINK_SDK_URL || "https://cdn.meshconnect.com/web-sdk/latest/mesh.js";
    </script>
  </head>
  <body>
    <div class="page-shell">
      <header class="top-nav">
        <div class="brand">
          <div class="brand-mark">M</div>
          <div class="brand-copy">
            <p class="brand-title">Mesh AWS Demo</p>
            <p class="brand-subtitle">Serverless sandbox experience</p>
          </div>
        </div>
        <nav class="nav-links">
          <a href="#workflow">Journey</a>
          <a href="#portfolio">Portfolio</a>
          <a href="#responses">Responses</a>
        </nav>
      </header>

      <main class="layout" id="workflow">
        <header class="hero">
          <span class="hero-badge">AWS + Mesh Sandbox</span>
          <h1>Kick off Mesh Link and see the data flow.</h1>
          <p class="lede">
            Powered by the Web Link SDK, AWS Lambda, and API Gateway â€” follow the three steps to complete the demo transfer.
          </p>
        </header>

        <div class="workflow-grid">
          <div class="workflow-column workflow-left">
          <section class="card step-card">
            <span class="step-pill">
              <span>Step 1</span>
            </span>
            <div class="step-heading">
              <h2>Connect your Coinbase sandbox</h2>
            </div>
            <p>
              Fetch a Link token from the AWS API, launch Mesh Link, and connect with the sandbox credentials. Use MFA code <code>123456</code> when prompted.
            </p>
            <button id="connect-btn" class="cta-button">
              <span aria-hidden="true">ðŸ”—</span>
              Launch Mesh Link
            </button>
            <div id="link-diagnostics" class="note"></div>
          </section>

          <section class="card step-card">
            <span class="step-pill">
              <span>Step 2</span>
            </span>
            <div class="step-heading">
              <h2>Approve the $50 USDC checkout</h2>
            </div>
            <p>
              Generate a transfer-configured Link token to open Mesh Link in a checkout-ready state, or reuse the stored access token if you already connected.
            </p>
            <div class="callout-list">
              <p><strong>Destination:</strong> <code>0x0Ff0000f0A0f0000F0F000000000ffFf00f0F0f0</code></p>
              <p><strong>Network:</strong> Ethereum&nbsp;sandbox&nbsp;(
                <code>e3c7fdd8-b1fc-4e51-85ae-bb276e075611</code>
              )</p>
            </div>
            <button id="pay-btn" class="cta-button accent">
              <span aria-hidden="true">ðŸ’¸</span>
              Pay $50 in USDC
            </button>
            <button type="button" class="text-link">Default transfer settings</button>
          </section>
        </div>

        <div class="workflow-column workflow-right">
          <section class="card step-card portfolio-card" id="portfolio">
            <span class="step-pill">
              <span>Step 3</span>
            </span>
            <div class="step-heading">
              <h2>Explore the linked portfolio</h2>
            </div>
            <p>
              Tokens and account details populate automatically after a successful connection. Adjust the controls to experiment with different portfolio queries.
            </p>
            <label class="text-label">
              Latest access token
              <textarea id="access-token" rows="5" readonly placeholder="Connect first to populate the access token."></textarea>
            </label>
            <div class="form-row">
              <label>
                Account ID (optional)
                <input id="account-id" placeholder="Auto-selected from Mesh payload" autocomplete="off">
              </label>
              <label>
                Portfolio type
                <input id="portfolio-type" value="coinbase" autocomplete="off">
              </label>
            </div>
            <div class="portfolio-actions">
              <button id="portfolio-btn" class="secondary cta-button dark">
                <span aria-hidden="true">ðŸ“Š</span>
                Read Portfolio
              </button>
              <p class="hint">Responses stream into the panel below for quick inspection.</p>
            </div>
          </section>
        </div>
      </div>

        <section class="card output" id="responses">
          <span class="section-tag">Diagnostics</span>
          <div class="output-header">
            <h2>Inspect API responses and events in real time.</h2>
            <button id="clear-output" class="link-like" type="button">ðŸ§¹ Clear log</button>
          </div>
          <pre id="out" aria-live="polite">API responses will appear here after you interact with Mesh Link.</pre>
        </section>
      </main>
    </div>

    <script type="module" src="app.js"></script>
  </body>
</html>
